<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pablo Reyes">

<title>taller4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="taller4_files/libs/clipboard/clipboard.min.js"></script>
<script src="taller4_files/libs/quarto-html/quarto.js"></script>
<script src="taller4_files/libs/quarto-html/popper.min.js"></script>
<script src="taller4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="taller4_files/libs/quarto-html/anchor.min.js"></script>
<link href="taller4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="taller4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="taller4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="taller4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="taller4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">taller4</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pablo Reyes </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="taller-4-transformación-de-datos-y-visualización" class="level1">
<h1>Taller 4: Transformación de datos y visualización</h1>
<section id="filtros-y-cargar-datos" class="level2">
<h2 class="anchored" data-anchor-id="filtros-y-cargar-datos">Filtros y cargar datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.2.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.2.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: timechange</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'timechange' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>agroAPI <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Rmdtos/data_raw/data_estaciones_agrometAPI.rds"</span>) </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>meta_agro <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Rmdtos/data_raw/metadata_estaciones_agrometAPI.rds"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Mascaras </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>mascara_agromet <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Rmdtos/data_raw/station_id_agromet_Pablo.rds"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>mascara_agv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Rmdtos/data_raw/station_id_agv_Pablo.rds"</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Mascaras</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Sets de datos</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>agv_meta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Rmdtos/data_raw/metadata_estaciones_agvAPI(1).rds"</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>api_agv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"C:/Rmdtos/data_raw/data_agvAPI.rds"</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Aplicación de máscaras</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>agv_meta <span class="ot">&lt;-</span> agv_meta[agv_meta<span class="sc">$</span>serial <span class="sc">%in%</span> mascara_agv,]</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>api_agv_rows <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(agv_meta[agv_meta<span class="sc">$</span>serial <span class="sc">%in%</span> mascara_agv,]))</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>api_agv_rows <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(agv_meta[agv_meta<span class="sc">$</span>tipo <span class="sc">==</span> <span class="st">"Humedad_Suelo"</span>,]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introducidos por coerción</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>api_agv_rows <span class="ot">&lt;-</span> api_agv_rows[<span class="sc">!</span><span class="fu">is.na</span>(api_agv_rows)]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> api_agv[<span class="fu">c</span>(api_agv_rows)]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtros</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#145 filas estaciones </span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#cantidad de variables</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data,ncol)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data,nrow)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># varibles unicas </span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>vars_un<span class="ot">&lt;-</span> <span class="fu">unique</span>(vars)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>ind785 <span class="ot">&lt;-</span> vars<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">5</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>data785 <span class="ot">&lt;-</span> data[ind785]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># los indicadores de las estaciones que tienen 7 variables</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>serial_est<span class="ot">&lt;-</span> agv_meta<span class="sc">$</span>serial[ind785]</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># separar para cada caso </span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>data_sep <span class="ot">&lt;-</span> <span class="fu">lapply</span>(vars_un,<span class="cf">function</span>(x){</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  data785[x <span class="sc">==</span> vars]</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">#agrupa en una lista las estaciones que tienen la misma cantidad de variables </span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co">#separa los valores unicos</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co">#nombres de variables </span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span>  <span class="fu">sapply</span>(data_sep[[<span class="dv">1</span>]], purrr<span class="sc">::</span>pluck,<span class="dv">1</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="do">##primer caso</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co">#seleccionar las tres primeras filas de profundidad</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data_sep[[<span class="dv">1</span>]],<span class="cf">function</span>(l){</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> l <span class="sc">|&gt;</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="co">#selleciona las filas por indice o por nombre</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">90</span>,<span class="dv">60</span>,<span class="dv">30</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="co"># desanidar lo datos</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(a), <span class="cf">function</span>(i){</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    a[[i]] <span class="sc">|&gt;</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">unnest</span>(<span class="st">'data'</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">hoist</span>(<span class="dv">3</span>,<span class="st">'value'</span>)<span class="sc">|&gt;</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>) ,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(out)) out<span class="sc">$</span>serial <span class="ot">&lt;-</span> serial_est[i]</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.list</span>(out)) out <span class="ot">&lt;-</span> out <span class="sc">|&gt;</span> <span class="fu">unnest</span>(<span class="st">'value'</span>)</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>data_final<span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,r)</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>data_final<span class="ot">&lt;-</span>  <span class="fu">rename</span>(data_final, <span class="at">Fecha_Hora =</span> timestamp, <span class="at">valores =</span> value, <span class="at">profundidad =</span>  z)</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>data_final</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,429 × 4
   Fecha_Hora       valores profundidad serial  
   &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;   
 1 2022-09-01 00:00    31.9          90 z6-08721
 2 2022-09-01 01:00    31.9          90 z6-08721
 3 2022-09-01 02:00    31.9          90 z6-08721
 4 2022-09-01 03:00    31.9          90 z6-08721
 5 2022-09-01 04:00    31.9          90 z6-08721
 6 2022-09-01 05:00    31.9          90 z6-08721
 7 2022-09-01 06:00    31.9          90 z6-08721
 8 2022-09-01 07:00    31.9          90 z6-08721
 9 2022-09-01 08:00    31.9          90 z6-08721
10 2022-09-01 09:00    31.9          90 z6-08721
# … with 9,419 more rows</code></pre>
</div>
</div>
</section>
<section id="ejercicios-funciones" class="level2">
<h2 class="anchored" data-anchor-id="ejercicios-funciones">1.Ejercicios funciones</h2>
<section id="eliminar-valores-anómalos-40pts" class="level3">
<h3 class="anchored" data-anchor-id="eliminar-valores-anómalos-40pts">1.1Eliminar valores anómalos (40pts)</h3>
<ul>
<li>Cree una función nombrada en R que permita tranformar en NA los valores anómalos de una variable <code>x</code>, si se encuentra fuera del rango:</li>
</ul>
<p><span class="math display">\[Q_{25} -1.5\cdot IQR &lt; x &lt; Q_{75}+IQR\]</span></p>
<p>dónde <span class="math inline">\(Q_{25}\)</span>: cuantil <span class="math inline">\(25\%\)</span>, <span class="math inline">\(IQR\)</span>: rango intercuartil y <span class="math inline">\(Q_{75}\)</span>: cuantil <span class="math inline">\(75\%\)</span></p>
<p>La función debe transformar en NA los valores que se encuentran fuera del rango.</p>
<ul>
<li>1.1.1 Pruebe la función con un vector numérico creado por usted.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="sc">-</span><span class="dv">10</span>,<span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="taller4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lim_inf <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,.<span class="dv">25</span>) <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(x)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>lim_sup <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,.<span class="dv">75</span>) <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(x)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(x)<span class="co">#rango interquartil</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.197677</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          0%          25%          50%          75%         100% 
-10.00000000  -0.49950038   0.06175631   0.69817699  10.00000000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>elimi_anomal <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  lim_inf <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,.<span class="dv">25</span>) <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(x)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  lim_sup <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,.<span class="dv">75</span>) <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(x)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  x[x <span class="sc">&lt;</span> lim_inf <span class="sc">|</span> x <span class="sc">&gt;</span> lim_sup] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">elimi_anomal</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]           NA           NA -0.560475647 -0.230177489  1.558708314
  [6]  0.070508391  0.129287735  1.715064987  0.460916206 -1.265061235
 [11] -0.686852852 -0.445661970  1.224081797  0.359813827  0.400771451
 [16]  0.110682716 -0.555841135  1.786913137  0.497850478 -1.966617157
 [21]  0.701355902 -0.472791408 -1.067823706 -0.217974915 -1.026004448
 [26] -0.728891229 -0.625039268 -1.686693311  0.837787044  0.153373118
 [31] -1.138136937  1.253814921  0.426464221 -0.295071483  0.895125661
 [36]  0.878133488  0.821581082  0.688640254  0.553917654 -0.061911711
 [41] -0.305962664 -0.380471001 -0.694706979 -0.207917278 -1.265396352
 [46]  2.168955965  1.207961998 -1.123108583 -0.402884835 -0.466655354
 [51]  0.779965118 -0.083369066  0.253318514 -0.028546755 -0.042870457
 [56]  1.368602284 -0.225770986  1.516470604 -1.548752804  0.584613750
 [61]  0.123854244  0.215941569  0.379639483 -0.502323453 -0.333207384
 [66] -1.018575383 -1.071791226  0.303528641  0.448209779  0.053004227
 [71]  0.922267468  2.050084686 -0.491031166           NA  1.005738524
 [76] -0.709200763 -0.688008616  1.025571370 -0.284773007 -1.220717712
 [81]  0.181303480 -0.138891362  0.005764186  0.385280401 -0.370660032
 [86]  0.644376549 -0.220486562  0.331781964  1.096839013  0.435181491
 [91] -0.325931586  1.148807618  0.993503856  0.548396960  0.238731735
 [96] -0.627906076  1.360652449 -0.600259587  2.187332993  1.532610626
[101] -0.235700359 -1.026420900</code></pre>
</div>
</div>
<ul>
<li>1.1.2 Pruebe la función utilizando <code>mutate</code> con el set de datos <code>iris</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>vector1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">elimi_anomal</span>(vector1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] -0.71040656  0.25688371 -0.24669188 -0.34754260 -0.95161857 -0.04502772
  [7] -0.78490447 -1.66794194 -0.38022652  0.91899661 -0.57534696  0.60796432
 [13] -1.61788271 -0.05556197  0.51940720  0.30115336  0.10567619 -0.64070601
 [19] -0.84970435 -1.02412879  0.11764660 -0.94747461 -0.49055744 -0.25609219
 [25]  1.84386201 -0.65194990  0.23538657  0.07796085 -0.96185663 -0.07130809
 [31]  1.44455086  0.45150405  0.04123292 -0.42249683 -2.05324722  1.13133721
 [37] -1.46064007  0.73994751  1.90910357 -1.44389316  0.70178434 -0.26219749
 [43] -1.57214416 -1.51466765 -1.60153617 -0.53090652 -1.46175558  0.68791677
 [49]  2.10010894 -1.28703048  0.78773885  0.76904224  0.33220258 -1.00837661
 [55] -0.11945261 -0.28039534  0.56298953 -0.37243876  0.97697339 -0.37458086
 [61]  1.05271147 -1.04917701 -1.26015524          NA -0.41685759  0.29822759
 [67]  0.63656967 -0.48378063  0.51686204  0.36896453 -0.21538051  0.06529303
 [73] -0.03406725  2.12845190 -0.74133610 -1.09599627  0.03778840  0.31048075
 [79]  0.43652348 -0.45836533 -1.06332613  1.26318518 -0.34965039 -0.86551286
 [85] -0.23627957 -0.19717589  1.10992029  0.08473729  0.75405379 -0.49929202
 [91]  0.21444531 -0.32468591  0.09458353 -0.89536336 -1.31080153  1.99721338
 [97]  0.60070882 -1.25127136 -0.61116592 -1.18548008</code></pre>
</div>
</div>
<ul>
<li>1.1.3 Transforme la función en una función anónima (lambda) y úsela con <code>mutate</code> con los datos <code>iris</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#iris |&gt;   </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(across(is.numeric, elimi_anomal,na.rm = TRUE))</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Tuve problema con el across</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="función-para-dplyr-ej.-mutate-con-multiples-columnas-como-argumentos-30-pts" class="level3">
<h3 class="anchored" data-anchor-id="función-para-dplyr-ej.-mutate-con-multiples-columnas-como-argumentos-30-pts">1.2Función para <code>{dplyr}</code> (ej., <code>mutate</code>) con multiples columnas como argumentos (30 pts)</h3>
<ul>
<li>1.2.1 Utilizando el set de datos <code>iris</code> y <code>mutate</code> haga el calculo en que cada columna numérica sea dividida por la raiz cuadrada de el promedio de <code>Sepal.Lenght</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>rqmean <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sqrt</span>(iris<span class="sc">$</span>Sepal.Length))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(is.numeric))<span class="sc">/</span>rqmean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of bare predicate functions was deprecated in tidyselect 1.1.0.
ℹ Please use wrap predicates in `where()` instead.
  # Was:
  data %&gt;% select(is.numeric)

  # Now:
  data %&gt;% select(where(is.numeric))</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in Ops.factor(left, right): '/' not meaningful for factors</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1       2.115026   1.4514885    0.5805954   0.0829422      NA
2       2.032084   1.2441330    0.5805954   0.0829422      NA
3       1.949142   1.3270752    0.5391243   0.0829422      NA
4       1.907671   1.2856041    0.6220665   0.0829422      NA
5       2.073555   1.4929596    0.5805954   0.0829422      NA
6       2.239439   1.6173729    0.7050087   0.1658844      NA
7       1.907671   1.4100174    0.5805954   0.1244133      NA
8       2.073555   1.4100174    0.6220665   0.0829422      NA
9       1.824728   1.2026619    0.5805954   0.0829422      NA
10      2.032084   1.2856041    0.6220665   0.0414711      NA
11      2.239439   1.5344307    0.6220665   0.0829422      NA
12      1.990613   1.4100174    0.6635376   0.0829422      NA
13      1.990613   1.2441330    0.5805954   0.0414711      NA
14      1.783257   1.2441330    0.4561821   0.0414711      NA
15      2.405324   1.6588440    0.4976532   0.0829422      NA
16      2.363853   1.8247284    0.6220665   0.1658844      NA
17      2.239439   1.6173729    0.5391243   0.1658844      NA
18      2.115026   1.4514885    0.5805954   0.1244133      NA
19      2.363853   1.5759018    0.7050087   0.1244133      NA
20      2.115026   1.5759018    0.6220665   0.1244133      NA
21      2.239439   1.4100174    0.7050087   0.0829422      NA
22      2.115026   1.5344307    0.6220665   0.1658844      NA
23      1.907671   1.4929596    0.4147110   0.0829422      NA
24      2.115026   1.3685463    0.7050087   0.2073555      NA
25      1.990613   1.4100174    0.7879509   0.0829422      NA
26      2.073555   1.2441330    0.6635376   0.0829422      NA
27      2.073555   1.4100174    0.6635376   0.1658844      NA
28      2.156497   1.4514885    0.6220665   0.0829422      NA
29      2.156497   1.4100174    0.5805954   0.0829422      NA
30      1.949142   1.3270752    0.6635376   0.0829422      NA
31      1.990613   1.2856041    0.6635376   0.0829422      NA
32      2.239439   1.4100174    0.6220665   0.1658844      NA
33      2.156497   1.7003151    0.6220665   0.0414711      NA
34      2.280911   1.7417862    0.5805954   0.0829422      NA
35      2.032084   1.2856041    0.6220665   0.0829422      NA
36      2.073555   1.3270752    0.4976532   0.0829422      NA
37      2.280911   1.4514885    0.5391243   0.0829422      NA
38      2.032084   1.4929596    0.5805954   0.0414711      NA
39      1.824728   1.2441330    0.5391243   0.0829422      NA
40      2.115026   1.4100174    0.6220665   0.0829422      NA
41      2.073555   1.4514885    0.5391243   0.1244133      NA
42      1.866200   0.9538353    0.5391243   0.1244133      NA
43      1.824728   1.3270752    0.5391243   0.0829422      NA
44      2.073555   1.4514885    0.6635376   0.2488266      NA
45      2.115026   1.5759018    0.7879509   0.1658844      NA
46      1.990613   1.2441330    0.5805954   0.1244133      NA
47      2.115026   1.5759018    0.6635376   0.0829422      NA
48      1.907671   1.3270752    0.5805954   0.0829422      NA
49      2.197968   1.5344307    0.6220665   0.0829422      NA
50      2.073555   1.3685463    0.5805954   0.0829422      NA
51      2.902977   1.3270752    1.9491418   0.5805954      NA
52      2.654150   1.3270752    1.8661995   0.6220665      NA
53      2.861506   1.2856041    2.0320840   0.6220665      NA
54      2.280911   0.9538353    1.6588440   0.5391243      NA
55      2.695622   1.1611908    1.9076706   0.6220665      NA
56      2.363853   1.1611908    1.8661995   0.5391243      NA
57      2.612679   1.3685463    1.9491418   0.6635376      NA
58      2.032084   0.9953064    1.3685463   0.4147110      NA
59      2.737093   1.2026619    1.9076706   0.5391243      NA
60      2.156497   1.1197197    1.6173729   0.5805954      NA
61      2.073555   0.8294220    1.4514885   0.4147110      NA
62      2.446795   1.2441330    1.7417862   0.6220665      NA
63      2.488266   0.9123642    1.6588440   0.4147110      NA
64      2.529737   1.2026619    1.9491418   0.5805954      NA
65      2.322382   1.2026619    1.4929596   0.5391243      NA
66      2.778564   1.2856041    1.8247284   0.5805954      NA
67      2.322382   1.2441330    1.8661995   0.6220665      NA
68      2.405324   1.1197197    1.7003151   0.4147110      NA
69      2.571208   0.9123642    1.8661995   0.6220665      NA
70      2.322382   1.0367775    1.6173729   0.4561821      NA
71      2.446795   1.3270752    1.9906129   0.7464798      NA
72      2.529737   1.1611908    1.6588440   0.5391243      NA
73      2.612679   1.0367775    2.0320840   0.6220665      NA
74      2.529737   1.1611908    1.9491418   0.4976532      NA
75      2.654150   1.2026619    1.7832573   0.5391243      NA
76      2.737093   1.2441330    1.8247284   0.5805954      NA
77      2.820035   1.1611908    1.9906129   0.5805954      NA
78      2.778564   1.2441330    2.0735551   0.7050087      NA
79      2.488266   1.2026619    1.8661995   0.6220665      NA
80      2.363853   1.0782486    1.4514885   0.4147110      NA
81      2.280911   0.9953064    1.5759018   0.4561821      NA
82      2.280911   0.9953064    1.5344307   0.4147110      NA
83      2.405324   1.1197197    1.6173729   0.4976532      NA
84      2.488266   1.1197197    2.1150262   0.6635376      NA
85      2.239439   1.2441330    1.8661995   0.6220665      NA
86      2.488266   1.4100174    1.8661995   0.6635376      NA
87      2.778564   1.2856041    1.9491418   0.6220665      NA
88      2.612679   0.9538353    1.8247284   0.5391243      NA
89      2.322382   1.2441330    1.7003151   0.5391243      NA
90      2.280911   1.0367775    1.6588440   0.5391243      NA
91      2.280911   1.0782486    1.8247284   0.4976532      NA
92      2.529737   1.2441330    1.9076706   0.5805954      NA
93      2.405324   1.0782486    1.6588440   0.4976532      NA
94      2.073555   0.9538353    1.3685463   0.4147110      NA
95      2.322382   1.1197197    1.7417862   0.5391243      NA
96      2.363853   1.2441330    1.7417862   0.4976532      NA
97      2.363853   1.2026619    1.7417862   0.5391243      NA
98      2.571208   1.2026619    1.7832573   0.5391243      NA
99      2.115026   1.0367775    1.2441330   0.4561821      NA
100     2.363853   1.1611908    1.7003151   0.5391243      NA
101     2.612679   1.3685463    2.4882661   1.0367775      NA
102     2.405324   1.1197197    2.1150262   0.7879509      NA
103     2.944448   1.2441330    2.4467950   0.8708931      NA
104     2.612679   1.2026619    2.3223817   0.7464798      NA
105     2.695622   1.2441330    2.4053239   0.9123642      NA
106     3.151804   1.2441330    2.7370927   0.8708931      NA
107     2.032084   1.0367775    1.8661995   0.7050087      NA
108     3.027390   1.2026619    2.6126794   0.7464798      NA
109     2.778564   1.0367775    2.4053239   0.7464798      NA
110     2.985919   1.4929596    2.5297372   1.0367775      NA
111     2.695622   1.3270752    2.1150262   0.8294220      NA
112     2.654150   1.1197197    2.1979684   0.7879509      NA
113     2.820035   1.2441330    2.2809106   0.8708931      NA
114     2.363853   1.0367775    2.0735551   0.8294220      NA
115     2.405324   1.1611908    2.1150262   0.9953064      NA
116     2.654150   1.3270752    2.1979684   0.9538353      NA
117     2.695622   1.2441330    2.2809106   0.7464798      NA
118     3.193275   1.5759018    2.7785638   0.9123642      NA
119     3.193275   1.0782486    2.8615060   0.9538353      NA
120     2.488266   0.9123642    2.0735551   0.6220665      NA
121     2.861506   1.3270752    2.3638528   0.9538353      NA
122     2.322382   1.1611908    2.0320840   0.8294220      NA
123     3.193275   1.1611908    2.7785638   0.8294220      NA
124     2.612679   1.1197197    2.0320840   0.7464798      NA
125     2.778564   1.3685463    2.3638528   0.8708931      NA
126     2.985919   1.3270752    2.4882661   0.7464798      NA
127     2.571208   1.1611908    1.9906129   0.7464798      NA
128     2.529737   1.2441330    2.0320840   0.7464798      NA
129     2.654150   1.1611908    2.3223817   0.8708931      NA
130     2.985919   1.2441330    2.4053239   0.6635376      NA
131     3.068861   1.1611908    2.5297372   0.7879509      NA
132     3.276217   1.5759018    2.6541505   0.8294220      NA
133     2.654150   1.1611908    2.3223817   0.9123642      NA
134     2.612679   1.1611908    2.1150262   0.6220665      NA
135     2.529737   1.0782486    2.3223817   0.5805954      NA
136     3.193275   1.2441330    2.5297372   0.9538353      NA
137     2.612679   1.4100174    2.3223817   0.9953064      NA
138     2.654150   1.2856041    2.2809106   0.7464798      NA
139     2.488266   1.2441330    1.9906129   0.7464798      NA
140     2.861506   1.2856041    2.2394395   0.8708931      NA
141     2.778564   1.2856041    2.3223817   0.9953064      NA
142     2.861506   1.2856041    2.1150262   0.9538353      NA
143     2.405324   1.1197197    2.1150262   0.7879509      NA
144     2.820035   1.3270752    2.4467950   0.9538353      NA
145     2.778564   1.3685463    2.3638528   1.0367775      NA
146     2.778564   1.2441330    2.1564973   0.9538353      NA
147     2.612679   1.0367775    2.0735551   0.7879509      NA
148     2.695622   1.2441330    2.1564973   0.8294220      NA
149     2.571208   1.4100174    2.2394395   0.9538353      NA
150     2.446795   1.2441330    2.1150262   0.7464798      NA</code></pre>
</div>
</div>
<ul>
<li>1.2.2 Utilice <code>across</code> y <code>mutate</code> junto con una función anónima (lambda)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric),<span class="at">.fns =</span> \(x) x<span class="sc">/</span>rqmean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 5
# Groups:   Species [3]
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
 1         2.12        1.45        0.581      0.0829 setosa 
 2         2.03        1.24        0.581      0.0829 setosa 
 3         1.95        1.33        0.539      0.0829 setosa 
 4         1.91        1.29        0.622      0.0829 setosa 
 5         2.07        1.49        0.581      0.0829 setosa 
 6         2.24        1.62        0.705      0.166  setosa 
 7         1.91        1.41        0.581      0.124  setosa 
 8         2.07        1.41        0.622      0.0829 setosa 
 9         1.82        1.20        0.581      0.0829 setosa 
10         2.03        1.29        0.622      0.0415 setosa 
# … with 140 more rows</code></pre>
</div>
</div>
<p>-1.2.3 Utilice <code>across</code> y <code>mutate</code> junto con una función nombrada (lambda)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>rqmeanfun <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){<span class="fu">group_by</span>(y) <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric))) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rqmean_ =</span> x<span class="sc">/</span>rqmean)}</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rqmeanfun</span>(iris<span class="sc">$</span>Sepal.Width, iris[iris<span class="sc">$</span>Species,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 6
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species rqmean_
          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt;
 1          5.1         3.5          1.4         0.2 setosa     1.45
 2          5.1         3.5          1.4         0.2 setosa     1.24
 3          5.1         3.5          1.4         0.2 setosa     1.33
 4          5.1         3.5          1.4         0.2 setosa     1.29
 5          5.1         3.5          1.4         0.2 setosa     1.49
 6          5.1         3.5          1.4         0.2 setosa     1.62
 7          5.1         3.5          1.4         0.2 setosa     1.41
 8          5.1         3.5          1.4         0.2 setosa     1.41
 9          5.1         3.5          1.4         0.2 setosa     1.20
10          5.1         3.5          1.4         0.2 setosa     1.29
# … with 140 more rows</code></pre>
</div>
</div>
<p>###1.3 Resumir por rangos tipo categórica (50pts)</p>
<ul>
<li>1.3.1 Cree una función que identifique tres grupos para un vector numérico <code>x</code>, alto, medio y bajo. Use la función <code>cut</code> y rangos de igual tamaño</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>clasifica <span class="ot">&lt;-</span> <span class="cf">function</span>(x,...){</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cut</span>(x,<span class="dv">3</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">'Low'</span>, <span class="st">'Med'</span>, <span class="st">'High'</span>))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>1.3.2 Pruebe la función con un vector numérico creado por usted.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clasifica</span>(vector1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] Low  Med  Med  Low  Low  Med  Low  Low  Low  Med  Low  Med  Low  Med  Med 
 [16] Med  Med  Low  Low  Low  Med  Low  Low  Med  High Low  Med  Med  Low  Med 
 [31] Med  Med  Med  Low  Low  Med  Low  Med  High Low  Med  Med  Low  Low  Low 
 [46] Low  Low  Med  High Low  Med  Med  Med  Low  Med  Med  Med  Low  Med  Low 
 [61] Med  Low  Low  High Low  Med  Med  Low  Med  Med  Med  Med  Med  High Low 
 [76] Low  Med  Med  Med  Low  Low  Med  Low  Low  Med  Med  Med  Med  Med  Low 
 [91] Med  Low  Med  Low  Low  High Med  Low  Low  Low 
Levels: Low Med High</code></pre>
</div>
</div>
<ul>
<li>1.3.3 Pruebe la función utilizando <code>mutate</code> con el set de datos <code>iris</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric),<span class="at">.fns=</span>clasifica))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1            Low         Med          Low         Low     setosa
2            Low         Med          Low         Low     setosa
3            Low         Med          Low         Low     setosa
4            Low         Med          Low         Low     setosa
5            Low         Med          Low         Low     setosa
6            Low        High          Low         Low     setosa
7            Low         Med          Low         Low     setosa
8            Low         Med          Low         Low     setosa
9            Low         Med          Low         Low     setosa
10           Low         Med          Low         Low     setosa
11           Low        High          Low         Low     setosa
12           Low         Med          Low         Low     setosa
13           Low         Med          Low         Low     setosa
14           Low         Med          Low         Low     setosa
15           Med        High          Low         Low     setosa
16           Med        High          Low         Low     setosa
17           Low        High          Low         Low     setosa
18           Low         Med          Low         Low     setosa
19           Med        High          Low         Low     setosa
20           Low        High          Low         Low     setosa
21           Low         Med          Low         Low     setosa
22           Low        High          Low         Low     setosa
23           Low         Med          Low         Low     setosa
24           Low         Med          Low         Low     setosa
25           Low         Med          Low         Low     setosa
26           Low         Med          Low         Low     setosa
27           Low         Med          Low         Low     setosa
28           Low         Med          Low         Low     setosa
29           Low         Med          Low         Low     setosa
30           Low         Med          Low         Low     setosa
31           Low         Med          Low         Low     setosa
32           Low         Med          Low         Low     setosa
33           Low        High          Low         Low     setosa
34           Low        High          Low         Low     setosa
35           Low         Med          Low         Low     setosa
36           Low         Med          Low         Low     setosa
37           Low         Med          Low         Low     setosa
38           Low         Med          Low         Low     setosa
39           Low         Med          Low         Low     setosa
40           Low         Med          Low         Low     setosa
41           Low         Med          Low         Low     setosa
42           Low         Low          Low         Low     setosa
43           Low         Med          Low         Low     setosa
44           Low         Med          Low         Low     setosa
45           Low        High          Low         Low     setosa
46           Low         Med          Low         Low     setosa
47           Low        High          Low         Low     setosa
48           Low         Med          Low         Low     setosa
49           Low        High          Low         Low     setosa
50           Low         Med          Low         Low     setosa
51          High         Med          Med         Med versicolor
52           Med         Med          Med         Med versicolor
53          High         Med          Med         Med versicolor
54           Low         Low          Med         Med versicolor
55           Med         Low          Med         Med versicolor
56           Med         Low          Med         Med versicolor
57           Med         Med          Med         Med versicolor
58           Low         Low          Med         Med versicolor
59           Med         Med          Med         Med versicolor
60           Low         Low          Med         Med versicolor
61           Low         Low          Med         Med versicolor
62           Med         Med          Med         Med versicolor
63           Med         Low          Med         Med versicolor
64           Med         Med          Med         Med versicolor
65           Med         Med          Med         Med versicolor
66           Med         Med          Med         Med versicolor
67           Med         Med          Med         Med versicolor
68           Med         Low          Med         Med versicolor
69           Med         Low          Med         Med versicolor
70           Med         Low          Med         Med versicolor
71           Med         Med          Med        High versicolor
72           Med         Low          Med         Med versicolor
73           Med         Low          Med         Med versicolor
74           Med         Low          Med         Med versicolor
75           Med         Med          Med         Med versicolor
76           Med         Med          Med         Med versicolor
77          High         Low          Med         Med versicolor
78           Med         Med         High         Med versicolor
79           Med         Med          Med         Med versicolor
80           Med         Low          Med         Med versicolor
81           Low         Low          Med         Med versicolor
82           Low         Low          Med         Med versicolor
83           Med         Low          Med         Med versicolor
84           Med         Low         High         Med versicolor
85           Low         Med          Med         Med versicolor
86           Med         Med          Med         Med versicolor
87           Med         Med          Med         Med versicolor
88           Med         Low          Med         Med versicolor
89           Med         Med          Med         Med versicolor
90           Low         Low          Med         Med versicolor
91           Low         Low          Med         Med versicolor
92           Med         Med          Med         Med versicolor
93           Med         Low          Med         Med versicolor
94           Low         Low          Med         Med versicolor
95           Med         Low          Med         Med versicolor
96           Med         Med          Med         Med versicolor
97           Med         Med          Med         Med versicolor
98           Med         Med          Med         Med versicolor
99           Low         Low          Med         Med versicolor
100          Med         Low          Med         Med versicolor
101          Med         Med         High        High  virginica
102          Med         Low         High        High  virginica
103         High         Med         High        High  virginica
104          Med         Med         High        High  virginica
105          Med         Med         High        High  virginica
106         High         Med         High        High  virginica
107          Low         Low          Med         Med  virginica
108         High         Med         High        High  virginica
109          Med         Low         High        High  virginica
110         High         Med         High        High  virginica
111          Med         Med         High        High  virginica
112          Med         Low         High        High  virginica
113         High         Med         High        High  virginica
114          Med         Low         High        High  virginica
115          Med         Low         High        High  virginica
116          Med         Med         High        High  virginica
117          Med         Med         High        High  virginica
118         High        High         High        High  virginica
119         High         Low         High        High  virginica
120          Med         Low         High         Med  virginica
121         High         Med         High        High  virginica
122          Med         Low          Med        High  virginica
123         High         Low         High        High  virginica
124          Med         Low          Med        High  virginica
125          Med         Med         High        High  virginica
126         High         Med         High        High  virginica
127          Med         Low          Med        High  virginica
128          Med         Med          Med        High  virginica
129          Med         Low         High        High  virginica
130         High         Med         High         Med  virginica
131         High         Low         High        High  virginica
132         High        High         High        High  virginica
133          Med         Low         High        High  virginica
134          Med         Low         High         Med  virginica
135          Med         Low         High         Med  virginica
136         High         Med         High        High  virginica
137          Med         Med         High        High  virginica
138          Med         Med         High        High  virginica
139          Med         Med          Med        High  virginica
140         High         Med         High        High  virginica
141          Med         Med         High        High  virginica
142         High         Med         High        High  virginica
143          Med         Low         High        High  virginica
144         High         Med         High        High  virginica
145          Med         Med         High        High  virginica
146          Med         Med         High        High  virginica
147          Med         Low         High        High  virginica
148          Med         Med         High        High  virginica
149          Med         Med         High        High  virginica
150          Med         Med         High        High  virginica</code></pre>
</div>
</div>
<ul>
<li>1.3.4 Transforme la función en una función anónima (lambda) y úsela con <code>mutate</code> con los datos <code>iris</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric),<span class="at">.fns =</span> \(x) <span class="fu">cut</span>(x, <span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Bajo'</span>, <span class="st">'Medio'</span>, <span class="st">'Alto'</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 5
# Groups:   Species [3]
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
   &lt;fct&gt;        &lt;fct&gt;       &lt;fct&gt;        &lt;fct&gt;       &lt;fct&gt;  
 1 Medio        Medio       Medio        Bajo        setosa 
 2 Medio        Bajo        Medio        Bajo        setosa 
 3 Bajo         Medio       Bajo         Bajo        setosa 
 4 Bajo         Medio       Medio        Bajo        setosa 
 5 Medio        Medio       Medio        Bajo        setosa 
 6 Alto         Alto        Alto         Medio       setosa 
 7 Bajo         Medio       Medio        Medio       setosa 
 8 Medio        Medio       Medio        Bajo        setosa 
 9 Bajo         Bajo        Medio        Bajo        setosa 
10 Medio        Medio       Medio        Bajo        setosa 
# … with 140 more rows</code></pre>
</div>
</div>
<ul>
<li>1.3.5 Utilice la función para clasificar los set de datos <code>agromet</code> en todas las variables climáticas, salvo en <code>grados_dias</code> y <code>horas_frio</code>, use la función como anónima.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>meta_agro <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">mes =</span> <span class="fu">floor_date</span>(fecha_de_alta, <span class="st">'1 month'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>,<span class="at">.fns=</span>clasifica)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 417 × 9
# Groups:   mes [23]
     ema institucion nombre_ema      comuna       region latitud longi…¹ fecha…²
   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;           &lt;chr&gt;        &lt;chr&gt;  &lt;fct&gt;   &lt;fct&gt;   &lt;fct&gt;  
 1     1 FDF         Azapa1          Arica        Arica… High    Med     Low    
 2     2 FDF         Azapa2          Arica        Arica… High    Med     Low    
 3     3 FDF         Tranque Lautaro Tierra Amar… Ataca… High    Med     High   
 4     4 FDF         Jotabeche       Tierra Amar… Ataca… High    Med     High   
 5     5 FDF         Hornitos        Tierra Amar… Ataca… High    Med     High   
 6     6 FDF         Copiapo         Copiapó      Ataca… High    Med     Med    
 7     7 FDF         Bodega          Copiapó      Ataca… High    Med     Med    
 8     8 FDF         Vallenar        Freirina     Ataca… High    Med     Med    
 9     9 FDF         Alto del Carmen Alto del Ca… Ataca… High    Med     Low    
10    10 FDF         El Palqui       Monte Patria Coqui… Med     Med     Med    
# … with 407 more rows, 1 more variable: mes &lt;dttm&gt;, and abbreviated variable
#   names ¹​longitud, ²​fecha_de_alta</code></pre>
</div>
</div>
<p>###1.4 Coeficiente de variación (50pts)</p>
<ul>
<li>Cree una función que permita seleccionar las variables numéricas cuyos valores son menores a un coeficiente de variación (CV) de 0.3 (30%).</li>
</ul>
<p><span class="math display">\[ CV = \frac{\sigma}{\bar{x}}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cvar <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)){</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(x)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    cv<span class="ot">&lt;-</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> cv <span class="sc">&lt;</span> <span class="fl">0.3</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> out <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">2</span>,<span class="at">FUN =</span>cvar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
        TRUE         TRUE        FALSE        FALSE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">select</span>(iris, <span class="fu">where</span>(is.numeric)),<span class="dv">2</span>,<span class="at">FUN=</span>cvar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
        TRUE         TRUE        FALSE        FALSE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cvar</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cvar</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">NA</span>),<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(cvar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width
1            5.1         3.5
2            4.9         3.0
3            4.7         3.2
4            4.6         3.1
5            5.0         3.6
6            5.4         3.9
7            4.6         3.4
8            5.0         3.4
9            4.4         2.9
10           4.9         3.1
11           5.4         3.7
12           4.8         3.4
13           4.8         3.0
14           4.3         3.0
15           5.8         4.0
16           5.7         4.4
17           5.4         3.9
18           5.1         3.5
19           5.7         3.8
20           5.1         3.8
21           5.4         3.4
22           5.1         3.7
23           4.6         3.6
24           5.1         3.3
25           4.8         3.4
26           5.0         3.0
27           5.0         3.4
28           5.2         3.5
29           5.2         3.4
30           4.7         3.2
31           4.8         3.1
32           5.4         3.4
33           5.2         4.1
34           5.5         4.2
35           4.9         3.1
36           5.0         3.2
37           5.5         3.5
38           4.9         3.6
39           4.4         3.0
40           5.1         3.4
41           5.0         3.5
42           4.5         2.3
43           4.4         3.2
44           5.0         3.5
45           5.1         3.8
46           4.8         3.0
47           5.1         3.8
48           4.6         3.2
49           5.3         3.7
50           5.0         3.3
51           7.0         3.2
52           6.4         3.2
53           6.9         3.1
54           5.5         2.3
55           6.5         2.8
56           5.7         2.8
57           6.3         3.3
58           4.9         2.4
59           6.6         2.9
60           5.2         2.7
61           5.0         2.0
62           5.9         3.0
63           6.0         2.2
64           6.1         2.9
65           5.6         2.9
66           6.7         3.1
67           5.6         3.0
68           5.8         2.7
69           6.2         2.2
70           5.6         2.5
71           5.9         3.2
72           6.1         2.8
73           6.3         2.5
74           6.1         2.8
75           6.4         2.9
76           6.6         3.0
77           6.8         2.8
78           6.7         3.0
79           6.0         2.9
80           5.7         2.6
81           5.5         2.4
82           5.5         2.4
83           5.8         2.7
84           6.0         2.7
85           5.4         3.0
86           6.0         3.4
87           6.7         3.1
88           6.3         2.3
89           5.6         3.0
90           5.5         2.5
91           5.5         2.6
92           6.1         3.0
93           5.8         2.6
94           5.0         2.3
95           5.6         2.7
96           5.7         3.0
97           5.7         2.9
98           6.2         2.9
99           5.1         2.5
100          5.7         2.8
101          6.3         3.3
102          5.8         2.7
103          7.1         3.0
104          6.3         2.9
105          6.5         3.0
106          7.6         3.0
107          4.9         2.5
108          7.3         2.9
109          6.7         2.5
110          7.2         3.6
111          6.5         3.2
112          6.4         2.7
113          6.8         3.0
114          5.7         2.5
115          5.8         2.8
116          6.4         3.2
117          6.5         3.0
118          7.7         3.8
119          7.7         2.6
120          6.0         2.2
121          6.9         3.2
122          5.6         2.8
123          7.7         2.8
124          6.3         2.7
125          6.7         3.3
126          7.2         3.2
127          6.2         2.8
128          6.1         3.0
129          6.4         2.8
130          7.2         3.0
131          7.4         2.8
132          7.9         3.8
133          6.4         2.8
134          6.3         2.8
135          6.1         2.6
136          7.7         3.0
137          6.3         3.4
138          6.4         3.1
139          6.0         3.0
140          6.9         3.1
141          6.7         3.1
142          6.9         3.1
143          5.8         2.7
144          6.8         3.2
145          6.7         3.3
146          6.7         3.0
147          6.3         2.5
148          6.5         3.0
149          6.2         3.4
150          5.9         3.0</code></pre>
</div>
</div>
<p>-1.4.2 Cree una función nombrada y apliquela a un vector aleatorio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>vector4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cvar</span>(vector4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<ul>
<li>1.4.3 Aplique la función con <code>apply</code> a las columnas numéricas del set de datos <code>iris</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">2</span>, <span class="at">FUN =</span> cvar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
        TRUE         TRUE        FALSE        FALSE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="fu">select</span>(iris,<span class="fu">where</span>(is.numeric)),<span class="dv">2</span>,<span class="at">FUN =</span>cvar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
        TRUE         TRUE        FALSE        FALSE </code></pre>
</div>
</div>
<ul>
<li>1.4.4 Aplique la función con <code>where</code> para seleccionar columnas del set de datos <code>iris</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(cvar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width
1            5.1         3.5
2            4.9         3.0
3            4.7         3.2
4            4.6         3.1
5            5.0         3.6
6            5.4         3.9
7            4.6         3.4
8            5.0         3.4
9            4.4         2.9
10           4.9         3.1
11           5.4         3.7
12           4.8         3.4
13           4.8         3.0
14           4.3         3.0
15           5.8         4.0
16           5.7         4.4
17           5.4         3.9
18           5.1         3.5
19           5.7         3.8
20           5.1         3.8
21           5.4         3.4
22           5.1         3.7
23           4.6         3.6
24           5.1         3.3
25           4.8         3.4
26           5.0         3.0
27           5.0         3.4
28           5.2         3.5
29           5.2         3.4
30           4.7         3.2
31           4.8         3.1
32           5.4         3.4
33           5.2         4.1
34           5.5         4.2
35           4.9         3.1
36           5.0         3.2
37           5.5         3.5
38           4.9         3.6
39           4.4         3.0
40           5.1         3.4
41           5.0         3.5
42           4.5         2.3
43           4.4         3.2
44           5.0         3.5
45           5.1         3.8
46           4.8         3.0
47           5.1         3.8
48           4.6         3.2
49           5.3         3.7
50           5.0         3.3
51           7.0         3.2
52           6.4         3.2
53           6.9         3.1
54           5.5         2.3
55           6.5         2.8
56           5.7         2.8
57           6.3         3.3
58           4.9         2.4
59           6.6         2.9
60           5.2         2.7
61           5.0         2.0
62           5.9         3.0
63           6.0         2.2
64           6.1         2.9
65           5.6         2.9
66           6.7         3.1
67           5.6         3.0
68           5.8         2.7
69           6.2         2.2
70           5.6         2.5
71           5.9         3.2
72           6.1         2.8
73           6.3         2.5
74           6.1         2.8
75           6.4         2.9
76           6.6         3.0
77           6.8         2.8
78           6.7         3.0
79           6.0         2.9
80           5.7         2.6
81           5.5         2.4
82           5.5         2.4
83           5.8         2.7
84           6.0         2.7
85           5.4         3.0
86           6.0         3.4
87           6.7         3.1
88           6.3         2.3
89           5.6         3.0
90           5.5         2.5
91           5.5         2.6
92           6.1         3.0
93           5.8         2.6
94           5.0         2.3
95           5.6         2.7
96           5.7         3.0
97           5.7         2.9
98           6.2         2.9
99           5.1         2.5
100          5.7         2.8
101          6.3         3.3
102          5.8         2.7
103          7.1         3.0
104          6.3         2.9
105          6.5         3.0
106          7.6         3.0
107          4.9         2.5
108          7.3         2.9
109          6.7         2.5
110          7.2         3.6
111          6.5         3.2
112          6.4         2.7
113          6.8         3.0
114          5.7         2.5
115          5.8         2.8
116          6.4         3.2
117          6.5         3.0
118          7.7         3.8
119          7.7         2.6
120          6.0         2.2
121          6.9         3.2
122          5.6         2.8
123          7.7         2.8
124          6.3         2.7
125          6.7         3.3
126          7.2         3.2
127          6.2         2.8
128          6.1         3.0
129          6.4         2.8
130          7.2         3.0
131          7.4         2.8
132          7.9         3.8
133          6.4         2.8
134          6.3         2.8
135          6.1         2.6
136          7.7         3.0
137          6.3         3.4
138          6.4         3.1
139          6.0         3.0
140          6.9         3.1
141          6.7         3.1
142          6.9         3.1
143          5.8         2.7
144          6.8         3.2
145          6.7         3.3
146          6.7         3.0
147          6.3         2.5
148          6.5         3.0
149          6.2         3.4
150          5.9         3.0</code></pre>
</div>
</div>
<ul>
<li>1.4.5 Aplique la función al set de datos agromet en el que se filtraron los valores anómalos.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#meta_agro |&gt; mutate(across(everything(),elimi_anomal, na.rm = TRUE)) |&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  drop_na() |&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  select(where(cvar))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="ejercicios-transformación-y-visualización" class="level2">
<h2 class="anchored" data-anchor-id="ejercicios-transformación-y-visualización">2.Ejercicios transformación y visualización</h2>
<section id="comparar-distribuciones-40pts" class="level3">
<h3 class="anchored" data-anchor-id="comparar-distribuciones-40pts">2.1Comparar distribuciones (40pts)</h3>
<ul>
<li>2.1.1 Compare las distribuciones de datos con y sin los valores anómalos obtenidas en el ejercicio 1.1. Agrúpe las estaciones por región de Chile.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>data_graf <span class="ot">&lt;-</span> agroAPI <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dia =</span> <span class="fu">as_date</span>(fecha_hora)) <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(station_id, <span class="at">dia =</span> <span class="fu">as_date</span>(fecha_hora)) <span class="sc">|&gt;</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(temp_promedio_aire<span class="sc">:</span>temp_maxima,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">.fns =</span> \(q) <span class="fu">sum</span>(<span class="fu">is.na</span>(q)),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">.names =</span> <span class="st">'{.col}_nas'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'station_id'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>data_graf_longer <span class="ot">&lt;-</span> data_graf <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(temp_promedio_aire_nas<span class="sc">:</span>temp_maxima_nas)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_graf_longer, <span class="fu">aes</span>(dia, <span class="fu">as.factor</span>(station_id), <span class="at">fill =</span> value))<span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="taller4_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>2.1.2 Cree un gráfico para visualizar la densidad de distribución de la precipitación acumulada diaria para las diferentes regiones de Chile. Use gráfico de <code>densidad</code> (<code>geom_density</code>)</li>
</ul>
<div class="cell">

</div>
</section>
<section id="valores-anómalos" class="level3">
<h3 class="anchored" data-anchor-id="valores-anómalos">2.2Valores anómalos</h3>
<ul>
<li>2.2.1 Visualice la cantidad de NAs implicitos diarios por estación para todas las variables de los datos <code>agromet</code>. Utilice gráficos de tipo heatmap (<code>geom_tile</code>).</li>
</ul>
<div class="cell">

</div>
<ul>
<li>2.2.2 Visualice la cantidad de NAs implicitos diarios por sesnor y profundidad para todas las variables del set de datos ordenados de <code>agv</code>. Utilice gráficos de tipo heatmap (<code>geom_tile</code>).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(api_agv,ncol)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(api_agv,nrow)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>vars_un<span class="ot">&lt;-</span> <span class="fu">unique</span>(vars)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>ind7 <span class="ot">&lt;-</span> vars <span class="sc">%in%</span> <span class="dv">7</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>serial_est<span class="ot">&lt;-</span> agv_meta<span class="sc">$</span>serial[ind7]</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>data_sep <span class="ot">&lt;-</span> <span class="fu">lapply</span>(vars_un,<span class="cf">function</span>(x){</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  api_agv[x <span class="sc">==</span> vars]</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data_sep[[<span class="dv">1</span>]],<span class="cf">function</span>(l){</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> l <span class="sc">|&gt;</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="co">#seleciona filas por indice o nombre</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">90</span>,<span class="dv">60</span>,<span class="dv">30</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(a), <span class="cf">function</span>(i){</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>    a[[i]] <span class="sc">|&gt;</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">unnest</span>(<span class="st">'data'</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">hoist</span>(<span class="dv">3</span>,<span class="st">'value'</span>)<span class="sc">|&gt;</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>) ,</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(out)) out<span class="sc">$</span>serial <span class="ot">&lt;-</span> serial_est[i]</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.list</span>(out)) out <span class="ot">&lt;-</span> out <span class="sc">|&gt;</span> <span class="fu">unnest</span>(<span class="st">'value'</span>)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>agv_final<span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,r)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'timestamp'</span>, <span class="st">'Valor'</span>, <span class="st">'Profundidad'</span>, <span class="st">'Serial'</span>)</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>names <span class="ot">-&gt;</span> <span class="fu">colnames</span>(agv_final)</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>agv_final <span class="ot">&lt;-</span> <span class="fu">tibble</span>(agv_final)</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>agv_graf <span class="ot">&lt;-</span> agv_final <span class="sc">|&gt;</span> </span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fecha_hora =</span> <span class="fu">ymd_hm</span>(timestamp)) <span class="sc">|&gt;</span> </span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">dia =</span> <span class="fu">as_date</span>(fecha_hora), Serial, Profundidad) <span class="sc">|&gt;</span> </span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">NAs =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(Valor)),</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">NAs_prop =</span> NAs<span class="sc">/</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'dia', 'Serial'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agv_graf, <span class="fu">aes</span>(dia, Serial, <span class="at">fill =</span> NAs)) <span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Profundidad) <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">ymd</span>(<span class="dv">20220831</span>), <span class="fu">ymd</span>(<span class="dv">20220905</span>)), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 204 rows containing missing values (`geom_tile()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="taller4_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="variación-variables-60pts" class="level3">
<h3 class="anchored" data-anchor-id="variación-variables-60pts">2.3 Variación variables (60pts)</h3>
<ul>
<li>2.3.1 Visualice la variación de la temperatura media diaria para todo Chile. Use tipo de gráfico <code>boxplot</code> (<code>geom_boxplot</code>).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>  regionA <span class="ot">&lt;-</span> agroAPI <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(station_id, <span class="at">dia =</span> <span class="fu">as_date</span>(fecha_hora)) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">temp_prom =</span> <span class="fu">mean</span>(temp_promedio_aire, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meta_agro, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'station_id'</span> <span class="ot">=</span> <span class="st">'ema'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(latitud))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'station_id'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>regionA <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(region, temp_prom)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11078 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="taller4_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>2.3.2 Cree un gráfico en ggplot para visualizar la variación de la temperatura media mensual para las diferentes regiones de Chile. Use tipo de gráfico <code>scatterplot</code> (<code>geom_point</code>) con barra de error (<code>geom_error_bar</code>).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> agroAPI <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(station_id, <span class="at">dia =</span> <span class="fu">as_date</span>(fecha_hora)) <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">temp_prom =</span> <span class="fu">mean</span>(temp_promedio_aire, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mes =</span> <span class="fu">floor_date</span>(dia, <span class="st">'1 month'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meta_agro, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'station_id'</span> <span class="ot">=</span> <span class="st">'ema'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(latitud))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'station_id'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> region[,<span class="sc">-</span><span class="dv">2</span>] <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mes)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>region <span class="sc">|&gt;</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(region, temp_prom, dia)) <span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11078 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="taller4_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>